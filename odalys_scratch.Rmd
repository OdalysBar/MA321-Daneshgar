---
title: "Scratch work Ecology Publicaton"
author: Odalys Barrientos
output: html_notebook
---

## Installing packages used
```{r}
#install.packages("vctrs")
#install.packages("ggplot2",repos = c("http://rstudio.org/_packages","http://cran.rstudio.com"))
library(ggplot2)
#install.packages("gplots")
library(gplots)
#install.packages("mosaic")
library(mosaic)


```
# New Marix of data 
```{r}
#our data is only 175 lines long 
EcologyBias <- EcologyBias_Daneshgar_Popo_2_[1:175, ]
EcologyBias # the name of our new matrix with all the data
```
# Contingency tables
# Contingency table: Contient where the work was done
```{r}
continent.work <- as.vector(EcologyBias$`Continent where work done`) # removing the column of all the continents where the work was done and making it into a vector

remove <- c ("Europe & Oceania", "META ANALYSIS","META ANALYSIS!") # removing these variables because it goes against the assumptions of a chisq test (mutually exclusive & independent)

# (continent.work %in% remove) ---> creates a vector of TRUE and FALSE to remove the elements we do not want 
continent.work <- continent.work [! continent.work %in% remove] # continent.work now has mutually exclusive and independent elements but contains NAs

continent.work[43] <- "Oceania" # fixing a miss spelling error
continent.work[61] <- "Oceania" # fixing a miss spelling error

continent.work <- c(continent.work[1:97], continent.work[99:168]) # removing NAs
# continent.work is not clean 
# I made a vector with all the continents and excluded the NAs

continent <- as.matrix(table(continent.work))
continent
```
# Case 1
# Chi-squared test: Continent where the work was done
```{r}
xchisq.test(tally(continent.work))
# we cannot use the pvalue because the test assumes randomness (our data is not random)
# we can use the observed frequency, expected frequency, and the pearson residual to show that all the continents are not equally represented
```
```{r}
# convert the data as a table
dt <- as.table(continent)
# Graph
balloonplot(t(dt), main ="Based on Region where the work was done", xlab ="", ylab="",
            label = FALSE, show.margins = FALSE)
```

# Continent with Sqr mileage
```{r}
sm.earth <- 197 # sqr miles of earths surface

sm.continent <- c(SqrMileage$`Sq. mi (million mi^2)`)

sm.continent <- as.numeric(sm.continent[2:8])

prop.cont <- sm.continent/sum(sm.continent)
#prop.cont
xchisq.test(tally(continent.work),p=prop.cont )

```

# Chisq test country
```{r}
country.work <- as.vector(EcologyBias$`Country where the work is done`)
remove <- c ("Brazil/Costa Rica/Puerto Rico", "Germany & New Zealand","Lesser Antilles/Guadelupe", "META ANALYSIS", "Multiple???", "US and Mexico", "Trinidad and Tobago")
country.work %in% remove
country.work <- country.work [! country.work %in% remove]
country.work[1:5] <- "USA"
country.work[8:11] <- "USA"
country.work <- c(country.work[1:25], country.work[27:34], country.work[36:77], country.work[79:95], country.work[97:121], country.work[123:144], country.work[146:168])
country.work
tally(country.work)
chisq.test(tally(country.work))

```
# country observed vs expected
```{r}
tally(country.work)
xchisq.test(tally(country.work))
```
# Chisq test region
```{r}
region.work <- as.vector(EcologyBias$`Regions where the work was done  (Popo defines)`)
region.work
remove <- c ("Multiple", "META ANALYSIS", "Multiple Ranges")
region.work %in% remove
region.work <- region.work [! region.work %in% remove]
region.work
region.work <- region.work[!is.na(region.work)]
region.work
tally(region.work)
chisq.test(tally(region.work))

```
# region observed vs expected
```{r}
tally(region.work)
xchisq.test(tally(region.work))
```
# Chisq test state
```{r}
state.work <- as.vector(EcologyBias$`State or Municipality where the work was done`)
state.work
remove <- c ("Multiple States", "Multiple", "META ANALYSIS", "OR/CA", "GA/FL", "NY, MA, CT")
state.work %in% remove
state.work <- state.work [! state.work %in% remove]
state.work
state.work <- state.work[!is.na(state.work)]
state.work
tally(state.work)
chisq.test(tally(state.work))

```
# state observed vs expected
```{r}
tally(state.work)
xchisq.test(tally(state.work))
```
# state with sqr mileage
```{r}
sm.state <- c(SqrMileage$'totalSQM')
sm.state <- c(sm.state[1:27])
#sm.state
prop.state <- sm.state/sum(sm.state)
#prop.state
chisq.test(tally(state.work),p=prop.state )

```


# Chisq test ecosystems popo def
```{r}
eco.po <- as.vector(EcologyBias$`Marine, Terrestrial, Freshwater, Mixed`)
eco.po
remove <- c ("Mixed")
eco.po %in% remove
eco.po <- eco.po [! eco.po %in% remove]
eco.po

tally(eco.po)
chisq.test(tally(eco.po))
```
# eco po observed vs expected
```{r}
tally(eco.po)
xchisq.test(tally(eco.po))
```


# Chisq ecosystem ped def
```{r}
eco.ped <- as.vector(EcologyBias$`Ecosystem (Ped defines)`)

remove <- c ("Multiple", "META-ANALYSIS")
eco.ped %in% remove
eco.ped <- eco.ped [! eco.ped %in% remove]

eco.ped <- c(eco.ped[1:50], eco.ped[52:169])
eco.ped
tally(eco.ped)
chisq.test(tally(eco.ped))
```
# eco ped observed vs expected
```{r}
tally(eco.ped)
xchisq.test(tally(eco.ped))
```
```{r}
?xchisq.test
```



